(this["webpackJsonplinky-ui"]=this["webpackJsonplinky-ui"]||[]).push([[0],{68:function(e,t,a){},96:function(e,t,a){},97:function(e,t,a){"use strict";a.r(t);var c=a(0),n=a.n(c),r=a(24),s=a.n(r),i=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,108)).then((function(t){var a=t.getCLS,c=t.getFID,n=t.getFCP,r=t.getLCP,s=t.getTTFB;a(e),c(e),n(e),r(e),s(e)}))},o=(a(67),a(68),a(17)),j=a(7),l=a(58),u=a.n(l).a.create(!1),b=a(14),d=a.n(b),h=a(21),O=a(104),x=a(1),p=function(e){var t=Object(c.useState)([]),a=Object(j.a)(t,2),n=a[0],r=a[1];Object(c.useEffect)((function(){r(e.src)}),[e.src]);var s=function(){r(["/logo192.png"])};return n.length>1?Object(x.jsx)(O.a,{interval:null,children:n.map((function(t,a){return Object(x.jsx)(O.a.Item,{children:Object(x.jsx)("img",Object(o.a)(Object(o.a)({alt:"Post",className:"w-100 h-auto"},e),{},{src:t,onError:s}))},e.postid.concat(a))}))}):Object(x.jsx)("img",Object(o.a)(Object(o.a)({alt:"Post",className:"w-100 h-auto"},e),{},{src:n,onError:s}))},m=a(13),f=a(8),v=function(e,t){var a=e.post,n=e.user,r=Object(f.f)(),s=Object(c.useState)(0),i=Object(j.a)(s,2),l=i[0],b=i[1],O=function(){var e=Object(h.a)(d.a.mark((function e(t,a){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a||r.push("Login"),e.prev=1,e.next=4,u.post("/api/post/".concat(t,"/upvote"),{},{headers:{Authorization:"Bearer ".concat(a.token)}});case 4:1===e.sent.data?b(l+1):b(l-1),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.log("Message send failed.",e.t0);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t,a){return e.apply(this,arguments)}}();return Object(c.useEffect)((function(){b(a.upvote.length)}),[a.upvote.length]),Object(x.jsxs)("div",Object(o.a)(Object(o.a)({},t),{},{className:"card-layout d-flex",children:[Object(x.jsxs)("div",{className:"card-ranking",children:[Object(x.jsx)("button",{className:"border-0",onClick:function(){return O(a._id,n)},children:"\u2191"}),Object(x.jsx)("p",{children:l})]}),Object(x.jsx)("div",{className:"card-right w-100",children:Object(x.jsxs)("div",{className:"card-bottom p-0 flex-grow-1",children:[Object(x.jsxs)("div",{children:[Object(x.jsx)("div",{className:"overflow-auto",children:Object(x.jsxs)("h3",{className:"card-title",children:["Posted by ",a.username," on ",a.date]})}),Object(x.jsx)("h2",{children:Object(x.jsx)("p",{children:a.title})})]}),a.attachment.every((function(e,t){return""!==e}))&&Object(x.jsx)(p,{postid:a._id,src:a.attachment}),Object(x.jsx)("p",{children:a.text}),Object(x.jsx)("div",{className:"card-bottom",children:Object(x.jsxs)(m.b,{to:{pathname:"/post/"+a._id},children:["See all ",a.comment_count," comments"]})})]})})]}))},g=a(105),y=a(106),S=a(61),N=a(102),w=function(e){return Object(x.jsxs)(g.a,{className:"navbar",bg:"light",expand:"lg",children:[Object(x.jsx)(g.a.Brand,{children:Object(x.jsx)(m.b,{to:"/",children:"Linky"})}),Object(x.jsx)(g.a.Toggle,{"aria-controls":"basic-navbar-nav"}),Object(x.jsxs)(g.a.Collapse,{id:"basic-navbar-nav",children:[Object(x.jsx)(y.a,{className:"mr-auto"})," ",e.user&&Object(x.jsx)(m.b,{to:"/submit",children:Object(x.jsx)(S.a,{children:"Create Post"})}),e.user?Object(x.jsx)(N.a,{title:e.user.username,children:Object(x.jsx)(N.a.Item,{onClick:function(){e.setUser(),localStorage.removeItem("user")},children:"Sign out"})}):Object(x.jsxs)("div",{children:[Object(x.jsx)(m.b,{to:"/login",children:Object(x.jsx)(S.a,{children:"Log in"})}),Object(x.jsx)(m.b,{to:"/signup",children:Object(x.jsx)(S.a,{className:"ml-2 btn-secondary",children:"Sign up"})})]})]})]})},k=a(103),C=a(107),L=function(e){var t=Object(c.useState)({}),a=Object(j.a)(t,2),n=a[0],r=a[1],s=Object(f.g)().pathname.split("/"),i=s[s.length-1];Object(c.useEffect)((function(){u.get("/api/post/"+i).then((function(e){r(e.data[0])}))}),[i]);var o=Object(c.useState)(""),l=Object(j.a)(o,2),b=l[0],O=l[1],v=function(){var t=Object(h.a)(d.a.mark((function t(a){var c;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,u.post("/api/post/".concat(i,"/comment"),{text:b},{headers:{Authorization:"Bearer ".concat(e.user.token)}});case 3:c=t.sent,console.log(c),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.log("Message send failed.",t.t0);case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}();return Object(x.jsx)("div",{className:"app",children:n&&Object.keys(n).length>0?Object(x.jsxs)("div",{children:[Object(x.jsxs)(C.a,{className:"mb-5",children:[Object(x.jsxs)(C.a.Header,{children:[Object(x.jsx)("p",{children:n.username}),Object(x.jsx)("p",{children:n.date})]}),Object(x.jsx)(p,{postid:n._id,src:n.attachment}),Object(x.jsxs)(C.a.Body,{style:{opacity:.8},children:[Object(x.jsx)(C.a.Text,{className:"my-1",children:n.text}),Object(x.jsxs)("div",{style:{overflow:"auto"},children:[Object(x.jsx)(C.a.Text,{className:"float-left mb-1",children:n.date}),Object(x.jsxs)(C.a.Text,{className:"float-right",children:[Object(x.jsx)("i",{className:"fas fa-share"}),Object(x.jsx)("i",{className:"fas fa-heart mx-2"})]})]})]})]},n._id),Object(x.jsxs)("div",{className:"comment",children:[e.user?Object(x.jsx)("div",{children:Object(x.jsxs)(k.a,{onSubmit:v,className:"overflow-hidden mb-5",children:[Object(x.jsx)(k.a.Group,{children:Object(x.jsx)(k.a.Control,{value:b,onChange:function(e){var t=e.target;return O(t.value)},placeholder:"Type your comment here"})}),Object(x.jsx)(S.a,{variant:"primary",type:"submit",className:"float-right",children:"Submit"}),Object(x.jsx)(S.a,{variant:"secondary",type:"submit",className:"float-right mr-2",children:"Cancel"})]})}):Object(x.jsx)("div",{children:Object(x.jsxs)(k.a,{className:"overflow-hidden mb-5",children:[Object(x.jsx)(k.a.Group,{children:Object(x.jsx)(k.a.Control,{placeholder:"You must be logged in to comment"})}),Object(x.jsx)(m.b,{to:"/login",children:Object(x.jsx)(S.a,{variant:"primary",type:"submit",className:"float-right",children:"Login"})})]})}),Object(x.jsx)("hr",{}),n&&n.comment.map((function(e){return Object(x.jsxs)(C.a.Text,{children:[Object(x.jsx)("span",{children:Object(x.jsx)("b",{children:e.username})}),Object(x.jsx)("span",{className:"ml-3",children:e.text})]})}))]})]}):Object(x.jsx)("div",{})})},E=a(62),T=function(e){var t=Object(c.useState)(""),a=Object(j.a)(t,2),n=a[0],r=a[1],s=Object(c.useState)(""),i=Object(j.a)(s,2),o=i[0],l=i[1],b=Object(c.useState)(""),O=Object(j.a)(b,2),p=O[0],m=O[1],f=function(){var t=Object(h.a)(d.a.mark((function t(a){var c;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),t.prev=1,t.next=4,u.post("/api/user/signup",{username:n,password:o});case 4:(c=t.sent).data&&(localStorage.setItem("token",JSON.stringify(c.data)),e.setUser(c.data),e.history.push("/")),t.next=13;break;case 8:t.prev=8,t.t0=t.catch(1),r(""),l(""),m("Unable to sign-up.");case 13:case"end":return t.stop()}}),t,null,[[1,8]])})));return function(e){return t.apply(this,arguments)}}();return Object(x.jsxs)("div",{className:"app signup",children:[Object(x.jsx)("h2",{children:"Sign up"}),Object(x.jsxs)(k.a,{onSubmit:f,children:[Object(x.jsxs)(k.a.Group,{controlId:"formBasicEmail",children:[Object(x.jsx)(k.a.Label,{children:"Username"}),Object(x.jsx)(k.a.Control,{type:"text",placeholder:"Enter username",value:n,onChange:function(e){var t=e.target;return r(t.value)}})]}),Object(x.jsxs)(k.a.Group,{controlId:"formBasicPassword",children:[Object(x.jsx)(k.a.Label,{children:"Password"}),Object(x.jsx)(k.a.Control,{type:"password",placeholder:"Password",value:o,onChange:function(e){var t=e.target;return l(t.value)}})]}),Object(x.jsx)(k.a.Text,{children:p}),Object(x.jsx)(S.a,{variant:"primary",type:"submit",children:"Submit"})]})]})},I=function(e){var t=Object(c.useState)(""),a=Object(j.a)(t,2),n=a[0],r=a[1],s=Object(c.useState)(""),i=Object(j.a)(s,2),o=i[0],l=i[1],b=Object(c.useState)(""),O=Object(j.a)(b,2),p=O[0],f=O[1],v=function(){var t=Object(h.a)(d.a.mark((function t(a){var c;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),t.prev=1,t.next=4,u.post("/api/user/login",{username:n,password:o});case 4:(c=t.sent).data&&(localStorage.setItem("user",JSON.stringify(c.data)),e.setUser(c.data),e.history.push("/")),t.next=13;break;case 8:t.prev=8,t.t0=t.catch(1),r(""),l(""),f("Unable to login.");case 13:case"end":return t.stop()}}),t,null,[[1,8]])})));return function(e){return t.apply(this,arguments)}}();return Object(x.jsxs)("div",{className:"app login",children:[Object(x.jsx)("h2",{children:"Log in"}),Object(x.jsxs)(k.a,{onSubmit:v,children:[Object(x.jsxs)(k.a.Group,{controlId:"formBasicEmail",children:[Object(x.jsx)(k.a.Label,{children:"Username"}),Object(x.jsx)(k.a.Control,{placeholder:"Enter username",value:n,onChange:function(e){var t=e.target;return r(t.value)}})]}),Object(x.jsxs)(k.a.Group,{controlId:"formBasicPassword",children:[Object(x.jsx)(k.a.Label,{children:"Password"}),Object(x.jsx)(k.a.Control,{type:"password",placeholder:"Password",value:o,onChange:function(e){var t=e.target;return l(t.value)}})]}),Object(x.jsxs)(k.a.Text,{children:["Don't have an account? Sign up ",Object(x.jsx)(m.b,{to:"/signup",children:Object(x.jsx)("u",{children:"here."})})]}),Object(x.jsx)(k.a.Text,{children:p}),Object(x.jsx)(S.a,{variant:"primary",type:"submit",children:"Submit"})]})]})},P=function(e){var t=Object(c.useState)(""),a=Object(j.a)(t,2),n=a[0],r=a[1],s=Object(c.useState)(""),i=Object(j.a)(s,2),o=i[0],l=i[1],b=Object(c.useState)(""),O=Object(j.a)(b,2),p=O[0],m=O[1],f=function(){var t=Object(h.a)(d.a.mark((function t(a){var c;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),t.prev=1,t.next=4,u.post("/api/post",{text:p,attachment:o,title:n},{headers:{Authorization:"Bearer ".concat(e.user.token)}});case 4:c=t.sent,console.log(c),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1),console.log("Message send failed.",t.t0);case 11:case"end":return t.stop()}}),t,null,[[1,8]])})));return function(e){return t.apply(this,arguments)}}();return Object(x.jsxs)("div",{className:"app login",children:[Object(x.jsx)("h2",{children:"Make a new post"}),Object(x.jsxs)(k.a,{onSubmit:f,children:[Object(x.jsx)(k.a.Group,{children:Object(x.jsx)(k.a.Control,{value:n,onChange:function(e){var t=e.target;return r(t.value)},placeholder:"Title"})}),Object(x.jsx)(k.a.Group,{children:Object(x.jsx)(k.a.Control,{value:o,onChange:function(e){var t=e.target;return l(t.value)},placeholder:"Attachment URL"})}),Object(x.jsx)(k.a.Group,{children:Object(x.jsx)(k.a.Control,{value:p,onChange:function(e){var t=e.target;return m(t.value)},className:"submit",placeholder:"Text"})}),Object(x.jsx)(S.a,{variant:"primary",type:"submit",children:"Submit"})]})]})},B=(a(96),function(e){var t=Object(c.useState)([]),a=Object(j.a)(t,2),n=a[0],r=a[1],s=Object(c.useState)(0),i=Object(j.a)(s,2),l=i[0],b=i[1],d=Object(c.useState)(!0),h=Object(j.a)(d,2),O=h[0],p=h[1],m=function(){u.get("api/posts/".concat(l)).then((function(e){e.data.length>0?(e.data.forEach((function(e){e.date=new Date(e.createdAt).toDateString()})),r(n.concat(e.data)),b(l+1)):p(!1)}))};return Object(c.useEffect)((function(){document.title="Linky",m()}),[]),Object(x.jsx)("div",Object(o.a)(Object(o.a)({},e),{},{children:Object(x.jsx)(E.a,{dataLength:n.length,next:m,hasMore:O,loader:Object(x.jsx)("h4",{children:"Loading..."}),endMessage:Object(x.jsx)("h4",{children:"End of posts..."}),scrollThreshold:.95,children:n.map((function(t){return Object(x.jsx)(v,{post:t,user:e.user},t._id)}))})}))}),U=function(){return Object(c.useEffect)((function(){document.title="About"}),[]),Object(x.jsx)("p",{className:"mx-1 mt-4",children:"Linky"})},G=function(){var e=Object(c.useState)(),t=Object(j.a)(e,2),a=t[0],n=t[1];return Object(c.useEffect)((function(){console.log(document.body.clientHeight),console.log(window.scrollY),console.log(window.innerHeight);var e=localStorage.getItem("user");e&&(e=JSON.parse(e),n(e))}),[]),Object(x.jsx)(m.a,{children:Object(x.jsxs)("div",{className:"App",children:[Object(x.jsx)(w,{user:a,setUser:n}),Object(x.jsxs)(f.c,{children:[Object(x.jsx)(f.a,{exact:!0,path:"/",render:function(e){return Object(x.jsx)(B,{className:"app",user:a})}}),Object(x.jsx)(f.a,{path:"/about",children:Object(x.jsx)(U,{})}),Object(x.jsx)(f.a,{path:"/post/:id",render:function(e){return Object(x.jsx)(L,{user:a})}}),Object(x.jsx)(f.a,{path:"/login",render:function(e){return Object(x.jsx)(I,Object(o.a)({setUser:n},e))}}),Object(x.jsx)(f.a,{path:"/signup",render:function(e){return Object(x.jsx)(T,Object(o.a)({setUser:n},e))}}),Object(x.jsx)(f.a,{path:"/submit",render:function(e){return Object(x.jsx)(P,{user:a})}})]})]})})};s.a.render(Object(x.jsx)(n.a.StrictMode,{children:Object(x.jsx)(G,{})}),document.getElementById("root")),i()}},[[97,1,2]]]);
//# sourceMappingURL=main.722cc98c.chunk.js.map
(this["webpackJsonplinky-ui"]=this["webpackJsonplinky-ui"]||[]).push([[0],{68:function(e,t,c){},96:function(e,t,c){},97:function(e,t,c){"use strict";c.r(t);var a=c(0),n=c.n(a),s=c(23),r=c.n(s),o=function(e){e&&e instanceof Function&&c.e(3).then(c.bind(null,107)).then((function(t){var c=t.getCLS,a=t.getFID,n=t.getFCP,s=t.getLCP,r=t.getTTFB;c(e),a(e),n(e),s(e),r(e)}))},i=(c(67),c(68),c(15)),j=c(7),l=c(58),u=c.n(l).a.create(!1),b=c(104),d=c(1),h=function(e){var t=Object(a.useState)([]),c=Object(j.a)(t,2),n=c[0],s=c[1];Object(a.useEffect)((function(){s(e.src)}),[e.src]);var r=function(){s(["/logo192.png"])};return n.length>1?Object(d.jsx)(b.a,{interval:null,children:n.map((function(t,c){return Object(d.jsx)(b.a.Item,{children:Object(d.jsx)("img",Object(i.a)(Object(i.a)({alt:"Post",className:"w-100 h-auto"},e),{},{src:t,onError:r}))},e.postid.concat(c))}))}):Object(d.jsx)("img",Object(i.a)(Object(i.a)({alt:"Post",className:"w-100 h-auto"},e),{},{src:n,onError:r}))},O=c(12),m=c(17),p=c.n(m),x=c(27),f=c(42),v=c(8),g=function(e){var t=e.post,c=e.user,n=Object(f.a)(e,["post","user"]),s=Object(v.f)(),r=Object(a.useState)(0),o=Object(j.a)(r,2),i=o[0],l=o[1];Object(a.useEffect)((function(){l(t.upvote.length)}),[t.upvote.length]);var b=function(){var e=Object(x.a)(p.a.mark((function e(t,c){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c||s.push("Login"),e.prev=1,e.next=4,u.post("/api/post/".concat(t,"/upvote"),{},{headers:{Authorization:"Bearer ".concat(c.token)}});case 4:1===e.sent.data?l(i+1):l(i-1),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.log("Message send failed.",e.t0);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t,c){return e.apply(this,arguments)}}();return Object(d.jsxs)("div",{className:n.className,children:[Object(d.jsx)("button",{className:"border-0 bg-transparent",onClick:function(){return b(t._id,c)},children:"\u2191"}),Object(d.jsx)("p",{children:i})]})},N=function(e,t){var c=e.post,a=e.user;return Object(d.jsxs)("div",Object(i.a)(Object(i.a)({},t),{},{className:"card-layout d-flex",children:[Object(d.jsx)(g,{className:"card-ranking",post:c,user:a}),Object(d.jsx)("div",{className:"card-right w-100",children:Object(d.jsxs)("div",{className:"card-bottom p-0 flex-grow-1",children:[Object(d.jsxs)("div",{children:[Object(d.jsx)("div",{className:"overflow-auto",children:Object(d.jsxs)("h3",{className:"card-title",children:["Posted by ",c.username," on ",c.date]})}),Object(d.jsx)("h2",{children:Object(d.jsx)("p",{children:c.title})})]}),c.attachment.every((function(e,t){return""!==e}))&&Object(d.jsx)(h,{postid:c._id,src:c.attachment}),Object(d.jsx)("p",{children:c.text}),Object(d.jsx)("div",{className:"card-bottom",children:Object(d.jsxs)(O.b,{to:{pathname:"/post/"+c._id},children:[Object(d.jsx)("i",{class:"far fa-comment-alt"})," See all ",c.comment_count," comments"]})})]})})]}))},y=c(105),S=c(106),w=c(61),k=c(102),C=function(e){return Object(d.jsxs)(y.a,{className:"navbar",bg:"light",expand:"lg",children:[Object(d.jsx)(y.a.Brand,{children:Object(d.jsx)(O.b,{to:"/",children:"Linky"})}),Object(d.jsx)(y.a.Toggle,{"aria-controls":"basic-navbar-nav"}),Object(d.jsxs)(y.a.Collapse,{id:"basic-navbar-nav",children:[Object(d.jsx)(S.a,{className:"mr-auto"})," ",e.user&&Object(d.jsx)(O.b,{to:"/submit",children:Object(d.jsx)(w.a,{children:"Create Post"})}),e.user?Object(d.jsx)(k.a,{title:e.user.username,children:Object(d.jsx)(k.a.Item,{onClick:function(){e.setUser(),localStorage.removeItem("user")},children:"Sign out"})}):Object(d.jsxs)("div",{children:[Object(d.jsx)(O.b,{to:"/login",children:Object(d.jsx)(w.a,{children:"Log in"})}),Object(d.jsx)(O.b,{to:"/signup",children:Object(d.jsx)(w.a,{className:"ml-2 btn-secondary",children:"Sign up"})})]})]})]})},_=c(103),P=function(e){var t=e.post_id,c=e.user,n=e.comment_id,s=e.buttonPress,r=e.setButtonPress,o=Object(a.useState)(""),i=Object(j.a)(o,2),l=i[0],b=i[1];return Object(d.jsx)("div",{className:"border border-secondary p-2 rounded",children:Object(d.jsxs)(_.a,{onSubmit:function(){n?u.post("/api/post/".concat(t,"/comment"),{text:l,comment_id:n},{headers:{Authorization:"Bearer ".concat(c.token)}}):u.post("/api/post/".concat(t,"/comment"),{text:l},{headers:{Authorization:"Bearer ".concat(c.token)}})},className:"overflow-hidden",children:[Object(d.jsx)(_.a.Group,{children:Object(d.jsx)(_.a.Control,{className:"border-0",value:l,onChange:function(e){var t=e.target;return b(t.value)},placeholder:"Type your comment here"})}),Object(d.jsxs)("div",{children:[Object(d.jsx)(w.a,{variant:"primary",type:"submit",className:"float-right",children:"Submit"}),Object(d.jsx)(w.a,{variant:"secondary",onClick:function(){return r?r(!s):b("")},className:"float-right mr-2",children:"Cancel"})]})]})})},L=function e(t){var c=t.post_id,n=t.comment,s=t.depth,r=t.user,o=(Object(f.a)(t,["post_id","comment","depth","user"]),Object(a.useState)(!1)),i=Object(j.a)(o,2),l=i[0],u=i[1],b=Object(v.f)();return Object(d.jsxs)("div",{className:"mb-2 ml-"+s,children:[Object(d.jsx)("div",{className:"comment-username",children:n.username}),Object(d.jsx)("div",{className:"",children:n.text}),!l&&Object(d.jsxs)("button",{className:"bold bg-white border-0 p-0 comment-item",onClick:function(){r||b.push("/login"),u(!l)},children:[Object(d.jsx)("i",{class:"far fa-comment-alt"})," Reply"]}),l&&Object(d.jsx)(P,{post_id:c,user:r,comment_id:n.comment_id,buttonPress:l,setButtonPress:u}),n.comment&&n.comment.map((function(t){return Object(d.jsx)(e,{post_id:c,user:r,depth:s+1,comment:t},t.comment_id)}))]})},E=function(e){var t=e.user,c=Object(a.useState)({}),n=Object(j.a)(c,2),s=n[0],r=n[1],o=Object(v.g)().pathname.split("/"),i=o[o.length-1];return Object(a.useEffect)((function(){u.get("/api/post/"+i).then((function(e){e.data[0].date=new Date(e.data[0].createdAt).toDateString(),r(e.data[0])}))}),[i]),Object(d.jsx)("div",{className:"card-layout app mb-5",children:Object.keys(s).length>0&&Object(d.jsxs)("div",{children:[Object(d.jsxs)("div",{className:"d-flex m-0",children:[Object(d.jsx)(g,{className:"card-ranking bg-white",user:t,post:s}),Object(d.jsx)("div",{className:"card-right w-100",children:Object(d.jsxs)("div",{className:"p-0 flex-grow-1",children:[Object(d.jsxs)("div",{children:[Object(d.jsx)("div",{className:"overflow-auto",children:Object(d.jsxs)("h3",{className:"card-title",children:["Posted by ",s.username," on ",s.date]})}),Object(d.jsx)("h2",{children:Object(d.jsx)("p",{children:s.title})})]}),s.attachment.every((function(e,t){return""!==e}))&&Object(d.jsx)(h,{postid:s._id,src:s.attachment}),Object(d.jsx)("p",{children:s.text}),Object(d.jsxs)("div",{className:"card-bottom",children:[s.comment_count||0," comments"]})]})})]}),Object(d.jsxs)("div",{className:"comment-layout",children:[t?Object(d.jsx)(P,{post_id:i,user:t}):Object(d.jsx)("div",{children:Object(d.jsxs)(_.a,{className:"overflow-hidden mb-5",children:[Object(d.jsx)(_.a.Group,{children:Object(d.jsx)(_.a.Control,{placeholder:"You must be logged in to comment"})}),Object(d.jsx)(O.b,{to:"/login",children:Object(d.jsx)(w.a,{variant:"primary",type:"submit",className:"float-right",children:"Login"})})]})}),Object(d.jsx)("hr",{}),s&&s.comment.map((function(e){return Object(d.jsx)(L,{post_id:i,user:t,depth:0,comment:e},e.comment_id)}))]})]})})},B=c(62),I=function(e){var t=Object(a.useState)(""),c=Object(j.a)(t,2),n=c[0],s=c[1],r=Object(a.useState)(""),o=Object(j.a)(r,2),i=o[0],l=o[1],b=Object(a.useState)(""),h=Object(j.a)(b,2),O=h[0],m=h[1],f=function(){var t=Object(x.a)(p.a.mark((function t(c){var a;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c.preventDefault(),t.prev=1,t.next=4,u.post("/api/user/signup",{username:n,password:i});case 4:(a=t.sent).data&&(localStorage.setItem("token",JSON.stringify(a.data)),e.setUser(a.data),e.history.push("/")),t.next=13;break;case 8:t.prev=8,t.t0=t.catch(1),s(""),l(""),m("Unable to sign-up. Please try a different username.");case 13:case"end":return t.stop()}}),t,null,[[1,8]])})));return function(e){return t.apply(this,arguments)}}();return Object(d.jsxs)("div",{className:"app signup",children:[Object(d.jsx)("h2",{children:"Sign up"}),Object(d.jsxs)(_.a,{onSubmit:f,children:[Object(d.jsxs)(_.a.Group,{controlId:"formBasicEmail",children:[Object(d.jsx)(_.a.Label,{children:"Username"}),Object(d.jsx)(_.a.Control,{type:"text",placeholder:"Enter username",value:n,onChange:function(e){var t=e.target;return s(t.value)}})]}),Object(d.jsxs)(_.a.Group,{controlId:"formBasicPassword",children:[Object(d.jsx)(_.a.Label,{children:"Password"}),Object(d.jsx)(_.a.Control,{type:"password",placeholder:"Password",value:i,onChange:function(e){var t=e.target;return l(t.value)}})]}),Object(d.jsx)(_.a.Text,{children:O}),Object(d.jsx)(w.a,{variant:"primary",type:"submit",children:"Submit"})]})]})},U=function(e){var t=Object(a.useState)(""),c=Object(j.a)(t,2),n=c[0],s=c[1],r=Object(a.useState)(""),o=Object(j.a)(r,2),i=o[0],l=o[1],b=Object(a.useState)(""),h=Object(j.a)(b,2),m=h[0],f=h[1],v=function(){var t=Object(x.a)(p.a.mark((function t(c){var a;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c.preventDefault(),t.prev=1,t.next=4,u.post("/api/user/login",{username:n,password:i});case 4:(a=t.sent).data&&(localStorage.setItem("user",JSON.stringify(a.data)),e.setUser(a.data),e.history.goBack()),t.next=13;break;case 8:t.prev=8,t.t0=t.catch(1),s(""),l(""),f("Unable to login.");case 13:case"end":return t.stop()}}),t,null,[[1,8]])})));return function(e){return t.apply(this,arguments)}}();return Object(d.jsxs)("div",{className:"app login",children:[Object(d.jsx)("h2",{children:"Log in"}),Object(d.jsxs)(_.a,{onSubmit:v,children:[Object(d.jsxs)(_.a.Group,{controlId:"formBasicEmail",children:[Object(d.jsx)(_.a.Label,{children:"Username"}),Object(d.jsx)(_.a.Control,{placeholder:"Enter username",value:n,onChange:function(e){var t=e.target;return s(t.value)}})]}),Object(d.jsxs)(_.a.Group,{controlId:"formBasicPassword",children:[Object(d.jsx)(_.a.Label,{children:"Password"}),Object(d.jsx)(_.a.Control,{type:"password",placeholder:"Password",value:i,onChange:function(e){var t=e.target;return l(t.value)}})]}),Object(d.jsxs)(_.a.Text,{children:["Don't have an account? Sign up ",Object(d.jsx)(O.b,{to:"/signup",children:Object(d.jsx)("u",{children:"here."})})]}),Object(d.jsx)(_.a.Text,{children:m}),Object(d.jsx)(w.a,{variant:"primary",type:"submit",children:"Submit"})]})]})},T=function(e){var t=Object(a.useState)(""),c=Object(j.a)(t,2),n=c[0],s=c[1],r=Object(a.useState)(""),o=Object(j.a)(r,2),i=o[0],l=o[1],b=Object(a.useState)(""),h=Object(j.a)(b,2),O=h[0],m=h[1],f=function(){var t=Object(x.a)(p.a.mark((function t(c){var a;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c.preventDefault(),t.prev=1,t.next=4,u.post("/api/post",{text:O,attachment:i,title:n},{headers:{Authorization:"Bearer ".concat(e.user.token)}});case 4:a=t.sent,console.log(a),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(1),console.log("Message send failed.",t.t0);case 11:case"end":return t.stop()}}),t,null,[[1,8]])})));return function(e){return t.apply(this,arguments)}}();return Object(d.jsxs)("div",{className:"app login",children:[Object(d.jsx)("h2",{children:"Make a new post"}),Object(d.jsxs)(_.a,{onSubmit:f,children:[Object(d.jsx)(_.a.Group,{children:Object(d.jsx)(_.a.Control,{value:n,onChange:function(e){var t=e.target;return s(t.value)},placeholder:"Title"})}),Object(d.jsx)(_.a.Group,{children:Object(d.jsx)(_.a.Control,{value:i,onChange:function(e){var t=e.target;return l(t.value)},placeholder:"Attachment URL"})}),Object(d.jsx)(_.a.Group,{children:Object(d.jsx)(_.a.Control,{value:O,onChange:function(e){var t=e.target;return m(t.value)},className:"submit",placeholder:"Text"})}),Object(d.jsx)(w.a,{variant:"primary",type:"submit",children:"Submit"})]})]})},A=(c(96),function(e){var t=Object(a.useState)([]),c=Object(j.a)(t,2),n=c[0],s=c[1],r=Object(a.useState)(0),o=Object(j.a)(r,2),l=o[0],b=o[1],h=Object(a.useState)(!0),O=Object(j.a)(h,2),m=O[0],p=O[1],x=function(){u.get("api/posts/".concat(l)).then((function(e){e.data.length>0?(e.data.forEach((function(e){e.date=new Date(e.createdAt).toDateString()})),s(n.concat(e.data)),b(l+1)):p(!1)}))};return Object(a.useEffect)((function(){document.title="Linky",x()}),[]),Object(d.jsx)("div",Object(i.a)(Object(i.a)({},e),{},{children:Object(d.jsx)(B.a,{dataLength:n.length,next:x,hasMore:m,loader:Object(d.jsx)("h4",{children:"Loading..."}),endMessage:Object(d.jsx)("h4",{children:"End of posts..."}),scrollThreshold:.95,children:n.map((function(t){return Object(d.jsx)(N,{post:t,user:e.user},t._id)}))})}))}),D=function(){return Object(a.useEffect)((function(){document.title="About"}),[]),Object(d.jsx)("p",{className:"mx-1 mt-4",children:"Linky"})},G=function(){var e=Object(a.useState)(),t=Object(j.a)(e,2),c=t[0],n=t[1];return Object(a.useEffect)((function(){console.log(document.body.clientHeight),console.log(window.scrollY),console.log(window.innerHeight);var e=localStorage.getItem("user");e&&(e=JSON.parse(e),n(e))}),[]),Object(d.jsx)(O.a,{children:Object(d.jsxs)("div",{className:"App",children:[Object(d.jsx)(C,{user:c,setUser:n}),Object(d.jsxs)(v.c,{children:[Object(d.jsx)(v.a,{exact:!0,path:"/",render:function(e){return Object(d.jsx)(A,{className:"app",user:c})}}),Object(d.jsx)(v.a,{path:"/about",children:Object(d.jsx)(D,{})}),Object(d.jsx)(v.a,{path:"/post/:id",render:function(e){return Object(d.jsx)(E,{user:c})}}),Object(d.jsx)(v.a,{path:"/login",render:function(e){return Object(d.jsx)(U,Object(i.a)({setUser:n},e))}}),Object(d.jsx)(v.a,{path:"/signup",render:function(e){return Object(d.jsx)(I,Object(i.a)({setUser:n},e))}}),Object(d.jsx)(v.a,{path:"/submit",render:function(e){return Object(d.jsx)(T,{user:c})}})]})]})})};r.a.render(Object(d.jsx)(n.a.StrictMode,{children:Object(d.jsx)(G,{})}),document.getElementById("root")),o()}},[[97,1,2]]]);
//# sourceMappingURL=main.b534c3ef.chunk.js.map